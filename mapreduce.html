<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc49486e5-164f-4134-bbc3-38b63f2d4058%2FAA238E8485C55D168DCF034BC7482B61.png?table=collection&amp;id=c97ea4eb-3d30-4977-8edc-ee98d0f07149">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>MapReduce&nbsp;|&nbsp;Patrick‚Äôs Blog</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="MapReduce">
  
    <meta name="description" content="MapReduce: Simplified Data Processing on Large Clusters">
    <meta property="og:description" content="MapReduce: Simplified Data Processing on Large Clusters">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ü•è&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc49486e5-164f-4134-bbc3-38b63f2d4058%2FAA238E8485C55D168DCF034BC7482B61.png?table=collection&amp;id=c97ea4eb-3d30-4977-8edc-ee98d0f07149"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;üòÄ&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>About me</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="categories.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;üìÉ&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>Categories</span>
        </div>
      </a>
    
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ü•è&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">MapReduce</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Sat, Apr 16, 2022</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--gray">
            <a href="tag/üìñNote.html">üìñNote</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--brown">
            <a href="tag/Distributed.html">Distributed</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/8ce269f74da54a35bade61d8d7cda45e" class="PageRoot"><h1 id="https://www.notion.so/a3845b11235a4f90bb59d51beec36373" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/a3845b11235a4f90bb59d51beec36373"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">MapReduce: Simplified Data Processing on Large Clusters</span></span></h1><div id="https://www.notion.so/2d530e91814440deac81810c08f8f0f8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">MapReduce is a programming model and an associated implementation for processing and generating large data sets.</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/3be036d359ca4f03af8ba7def3e0ea72" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">map</em></span><span class="SemanticString"> function: processes a key/value pair to generate a set of intermediate key/value pairs</span></span></li><li id="https://www.notion.so/4d19e42693e845a88110eabbc6e7a7e8" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">reduce</em></span><span class="SemanticString"> function: merges all intermediate values associated with the same intermediate key</span></span></li></ul><div id="https://www.notion.so/723e76d3e539459fad0d06cb204d4476" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">partitioning the input data, scheduling the program‚Äôs execution across a set of machines, handling machine failures, and managing the required inter-machine communication</span></span></p></div><h2 id="https://www.notion.so/764876b628944e0296ca7a81c1ae7876" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/764876b628944e0296ca7a81c1ae7876"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">1 Introduction</span></span></h2><div id="https://www.notion.so/9d25920332dc49f4853547b218afe24e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The issues of how to parallelize the computation, distribute the data, and handle failures conspire to obscure the original simple computation with large amounts of complex code to deal with these issues.</span></span></p></div><div id="https://www.notion.so/f18b05f8daf4432fa23e188a053606eb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">new abstraction:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/fc04724b52094c688b140f760cd82fe6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">map</em></span><span class="SemanticString"> operation to each logical ‚Äúrecord‚Äù in our input in order to compute a set of intermediate key/value pairs</span></span></li><li id="https://www.notion.so/7d7adde24b4c4c5bb23d255898f28ebd" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">reduce</em></span><span class="SemanticString"> operation to all the values that shared the same key, in order to combine the derived data appropriately</span></span></li></ul><div id="https://www.notion.so/4fcb1bd5506b478a8e721542d99f3826" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">(inspired by the </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">map</em></span><span class="SemanticString"> and </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">reduce</em></span><span class="SemanticString"> primitives present in Lisp and many other functional languages)</span></span></p></div><h2 id="https://www.notion.so/b63c8898ee8c4897a478dbc6af5debee" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/b63c8898ee8c4897a478dbc6af5debee"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">2 Programming Model</span></span></h2><div id="https://www.notion.so/4bf2ff610c3c43a0b7180c6516aed4d7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">input</em></span><span class="SemanticString">: key/value pairs</span></span></p></div><div id="https://www.notion.so/1eebd5fd51664892b47d0484053b810a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">output</em></span><span class="SemanticString">: key/value pairs</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/a94ced7f3c4f46bf8fd7bdf92044c959" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Map</em></span><span class="SemanticString">: written by the user, take an input pair and produces a set of </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">intermediate</em></span><span class="SemanticString"> key/value pairs. The MapReduce library groups together all intermediate values associated with the same intermediate key </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">I</em></span><span class="SemanticString"> and passes them to the </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Reduce</em></span><span class="SemanticString"> function.</span></span></li><li id="https://www.notion.so/d2ed940287294db5879aed15e374a956" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Reduce</em></span><span class="SemanticString">: also written by the user, accepts an intermediate key </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">I</em></span><span class="SemanticString"> and a set of values for that key. It merges together these values to form a possibly smaller set of values. Typically just zero or one output value is produced per </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Reduce</em></span><span class="SemanticString"> invocation. The intermediate values are supplied to the user‚Äôs reduce function via an iterator. (to handle lists of values that are too large to fit in memory)</span></span></li></ul><h3 id="https://www.notion.so/a8e3049c84a64733845f17b0f3b5f006" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/a8e3049c84a64733845f17b0f3b5f006"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">2.1 Example</span></span></h3><div id="https://www.notion.so/c2aab4034cc94d188172cee255194c40" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Counting the number of occurrences of each word in a large collection of documents. The user would write code similar to the following pseudo-code:</span></span></p></div><pre id="https://www.notion.so/b430126d2bcc45e9963fa2f544fcdf26" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token function">map</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> String value<span class="token punctuation">)</span><span class="token operator">:</span>
  <span class="token comment">// key: document name</span>
  <span class="token comment">// value: document contents</span>
  <span class="token keyword">for</span> each word w in value<span class="token operator">:</span>
    <span class="token function">EmitIntermediate</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">reduce</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> Iterator values<span class="token punctuation">)</span><span class="token operator">:</span>
  <span class="token comment">// key: a word</span>
  <span class="token comment">// values: a list of counts</span>
  <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> each v in values<span class="token operator">:</span>
    result <span class="token operator">+=</span> <span class="token function">ParseInt</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Emit</span><span class="token punctuation">(</span><span class="token function">AsString</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span></span></code></pre><div id="https://www.notion.so/3d4cc5cfb2644ab5871d788fe6ca0874" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">In addition, the user writes code to fill in a </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">mapreduce specification</em></span><span class="SemanticString"> object with the names of the input and output files, and optional tuning parameters. The user then invokes the </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">MapReduce</em></span><span class="SemanticString"> function, passing it the specification object.</span></span></p></div><h3 id="https://www.notion.so/3de2ecbab92d4f1b8aa73814605d2a07" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/3de2ecbab92d4f1b8aa73814605d2a07"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">2.2 Types</span></span></h3><div id="https://www.notion.so/825b804ff86d40928802023896e30696" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Conceptually the map and reduce functions supplied by the user have associated types:</span></span></p></div><pre id="https://www.notion.so/f7a2b4720bf34ab0ace04738e33b44be" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token function">map</span>     <span class="token punctuation">(</span>k1<span class="token punctuation">,</span> v1<span class="token punctuation">)</span>       <span class="token operator">-></span> <span class="token function">list</span><span class="token punctuation">(</span>k2<span class="token punctuation">,</span> v2<span class="token punctuation">)</span>
<span class="token function">reduce</span>  <span class="token punctuation">(</span>k2<span class="token punctuation">,</span> <span class="token function">list</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token function">list</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/86b8f6f0d64c408088cbced09a732bae" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The input keys and values are drawn from a different domain than the output keys and values. The intermediate keys and values are from the same domain as the output keys and values.</span></span></p></div><h3 id="https://www.notion.so/3de0335119c2430a913d94783c2553a6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/3de0335119c2430a913d94783c2553a6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">2.3 More Examples</span></span></h3><ul class="BulletedListWrapper"><li id="https://www.notion.so/25c11baf4c424b28a0fa00af0bee92c9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Distributed Grep</strong></span></span><div id="https://www.notion.so/98f5408ea10b45f286d3ef22c802ec9c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The map function emits a line if it matches a supplied pattern.</span></span></p></div><div id="https://www.notion.so/d1b5a4999a17421bb4ac0b0dca199977" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The reduce function is an identity function that just copies the supplied intermediate data to the output.</span></span></p></div></li><li id="https://www.notion.so/3945727a2afc4dfbaeb51acb49388194" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Count of URL Access Frequency</strong></span></span><div id="https://www.notion.so/ea72a37ac6a94317909b7f320246b064" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The map function processes logs of web page requests and outputs </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;URL, 1&gt;</code></span><span class="SemanticString">.</span></span></p></div><div id="https://www.notion.so/a3a9308d4e1f424791c7e1afd4082fca" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The reduce function adds together all values for the same URL and emits a </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;URL, total count&gt;</code></span><span class="SemanticString"> pair.</span></span></p></div></li><li id="https://www.notion.so/2c64f89bc5a24d659a6ac5b491645891" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Reverse Web-Link Graph</strong></span></span><div id="https://www.notion.so/6d73b28137dc414c98f7761d23f85f8a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The map function outputs </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;target, source&gt;</code></span><span class="SemanticString"> pairs for each link to a </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">target</code></span><span class="SemanticString"> URL found in a page named </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">source</code></span><span class="SemanticString">.</span></span></p></div><div id="https://www.notion.so/0fae65199aa041c385497125f704f3aa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The reduce function concatenates the list of all source URLs associated with a given target URL and emits the pair: </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;target, list(source)&gt;</code></span><span class="SemanticString">.</span></span></p></div></li><li id="https://www.notion.so/4e36e815ab2a43ec989629b518446622" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Term-Vector per Host</strong></span></span><div id="https://www.notion.so/81cc552c48504edcab2db833e3db1d9f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">A term vector summarizes the most important words that occur in a document or a set of documents as a list of </span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Math" data-latex="‚ü®word, frequency‚ü©"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">‚ü®</mo><mi>w</mi><mi>o</mi><mi>r</mi><mi>d</mi><mo separator="true">,</mo><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mi>u</mi><mi>e</mi><mi>n</mi><mi>c</mi><mi>y</mi><mo stretchy="false">‚ü©</mo></mrow><annotation encoding="application/x-tex">‚ü®word, frequency‚ü©</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">‚ü®</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">‚ü©</span></span></span></span></span></span><span class="SemanticString"> pairs.</span></span></p></div><div id="https://www.notion.so/5a8af4e0df574144b1fb13019e8dd2a4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The map function emits a </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;hostname, term vector&gt;</code></span><span class="SemanticString"> pair for each input document (where the hostname is extracted from the URL of the document).</span></span></p></div><div id="https://www.notion.so/d9fc6ca3a7f847419c4c1deefad1f52b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The reduce function is passed all per-document term vectors for a given host. It adds these term vectors together, throwing away infrequent terms, and then emits a final </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;hostname, term vector&gt;</code></span><span class="SemanticString"> pair.</span></span></p></div></li><li id="https://www.notion.so/f1bedcd17e2b4804aee4f6ab43258b99" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Inverted Index</strong></span></span><div id="https://www.notion.so/2c5a9173a1f946a88ae891349ee340ab" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The map function parses each document, and emits a sequence of </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;word, document ID&gt;</code></span><span class="SemanticString"> pairs.</span></span></p></div><div id="https://www.notion.so/5a9742ad2acf4835af8d00a377a68da3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The reduce function accepts all pairs for a given word, sorts the corresponding document IDs and emits a </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;word, list(document ID)&gt;</code></span><span class="SemanticString"> pair.</span></span></p></div><div id="https://www.notion.so/b205c5eb4b2e4c33a6d8806c2c122b10" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The set of all output pairs forms a simple inverted index. It is easy to augment this computation to keep track of word position.</span></span></p></div></li><li id="https://www.notion.so/96cc2598eab5438aaa0d4223d5351f02" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Distributed Sort</strong></span></span><div id="https://www.notion.so/7e55ad0f2d55457fbb056128f4411f25" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The map function extracts the key from each record, and emits a </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;key, record&gt;</code></span><span class="SemanticString"> pair.</span></span></p></div><div id="https://www.notion.so/6a59e3391e7c49589a8cfeb8dfaa9518" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The reduce function emits all pairs unchanged.</span></span></p></div><div id="https://www.notion.so/89ba3725d7024cd0933ad1de78696f6c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">This computation depends on the partitioning facilities described in Section 4.1 and the ordering properties described in Section 4.2.</span></span></p></div></li></ul><h2 id="https://www.notion.so/6a3961d672e542979f65b8e115d3d8c1" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/6a3961d672e542979f65b8e115d3d8c1"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">3 Implementation</span></span></h2><div id="https://www.notion.so/681f62df8a4441d0ad750a28c3a75c69" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">This section describes an implementation targeted to the computing environment: large clusters of commodity PCs connected together with switched Ethernet.</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/0f8fe3a0a5df4dc3b2df22bf23c68f93" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">A cluster consists of hundreds of thousands of machines, and therefore machine failures are common.</span></span></li><li id="https://www.notion.so/9ab9fd21199140448ae0f55743ad4ba3" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">A distributed file system (GFS) is used to manage the data stored on the disks attached directly to individual machines. The file system uses replication to provide availability and reliability on top of unreliable hardware.</span></span></li><li id="https://www.notion.so/ec3539c99a794afa92bdf75fba082341" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Users submit jobs to a scheduling system. Each job consists of a set of tasks, and is mapped by the scheduler to a set of available machines within a cluster.</span></span></li></ul><h3 id="https://www.notion.so/ffd71347b36741a084756a50e61f4bb4" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/ffd71347b36741a084756a50e61f4bb4"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">3.1 Execution Overview</span></span></h3><div id="https://www.notion.so/e3faf1eae93a49a0a011a33b85f23138" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Map</em></span><span class="SemanticString"> invocations are distributed across multiple machines by automatically partitioning the input data into a set of </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">M splits</em></span><span class="SemanticString">. The input splits can be processed in parallel by different machines.</span></span></p></div><div id="https://www.notion.so/75081ac5922141beaaa6ed306ac8566c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Reduce</em></span><span class="SemanticString"> invocations are distributed by partitioning the intermediate key space into </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">R</em></span><span class="SemanticString"> pieces using a partitioning function (e.g., </span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Math" data-latex="hash(key) \mod R"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">)</mo><mspace></mspace><mspace width="0.6666666666666666em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext>‚Äâ</mtext><mtext>‚Äâ</mtext><mi>R</mi></mrow><annotation encoding="application/x-tex">hash(key) \mod R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span></span></span><span class="SemanticString">). The number of partitions (</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">R</em></span><span class="SemanticString">) and the partitioning function are specified by the user.</span></span></p></div><div id="https://www.notion.so/e287891ffbb04379bdaeba82991db9b1" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd11902bf-f6ad-432c-a3fd-50daff457544%2FUntitled.png?width=981&amp;table=block&amp;id=e287891f-fbb0-4379-bdae-ba82991db9b1"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd11902bf-f6ad-432c-a3fd-50daff457544%2FUntitled.png?width=981&amp;table=block&amp;id=e287891f-fbb0-4379-bdae-ba82991db9b1" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/c8e44bce772f4e7b874e86f22c3b5943" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">When the user program calls the </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">MapReduce</code></span><span class="SemanticString"> function, the following sequence of actions occurs:</span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/508f5ec8f8c54f14893aad04c1108775" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">The MapReduce library in the user program first splits the input files into </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">M</em></span><span class="SemanticString"> pieces of typically 16 megabytes to 64 megabytes (MB) per piece (controllable by the user via an optional parameter). It then starts up many copies of the program on a cluster of machines.</span></span></li><li id="https://www.notion.so/0d2a15ffdd2241acb19a1e37488dddbb" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">One of the copies of the program is special ‚Äî the master. The rest are workers that are assigned work by the master. There are </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">M</em></span><span class="SemanticString"> map tasks and </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">R</em></span><span class="SemanticString"> reduce tasks to assign. The master picks idle workers and assigns each one a map task or a reduce task.</span></span></li><li id="https://www.notion.so/960c721780e343f2a61ceda1f7535036" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">A worker who is assigned a map task reads the contents of the corresponding input split. It parses key/value pairs out of the input data and passes each pair to the user-defined </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Map</code></span><span class="SemanticString"> function. The intermediate key/value </span></span></li></ol><div id="https://www.notion.so/d7cd231e100b4f1da7d5b763e858b2e6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div></article>
  <footer class="Footer">
  <div>&copy; Patrick‚Äôs Blog 2019-2021</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>