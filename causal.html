<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Ffc9b3a94-67d3-4485-bdf3-5e0c0b341ebe%2FAA238E8485C55D168DCF034BC7482B61.png?table=collection&amp;id=c97ea4eb-3d30-4977-8edc-ee98d0f07149">

<style>
  :root {
    font-size: 20px;
  }
</style>

  <title>大规模非线性 SCM 的主动因果发现&nbsp;|&nbsp;Patrick’s Blog</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="大规模非线性 SCM 的主动因果发现">
  
    <meta name="description" content="Interventions, Where and How? Experimental Design for Causal Models at Scale">
    <meta property="og:description" content="Interventions, Where and How? Experimental Design for Causal Models at Scale">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🧙‍♂️&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Ffc9b3a94-67d3-4485-bdf3-5e0c0b341ebe%2FAA238E8485C55D168DCF034BC7482B61.png?table=collection&amp;id=c97ea4eb-3d30-4977-8edc-ee98d0f07149"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>About me</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="categories.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📃&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>Categories</span>
        </div>
      </a>
    
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🧙‍♂️&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">大规模非线性 SCM 的主动因果发现</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Thu, Apr 20, 2023</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--gray">
            <a href="tag/📖Note.html">📖Note</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--red">
            <a href="tag/Causal.html">Causal</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--pink">
            <a href="tag/🧪BOED.html">🧪BOED</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/4c292b77feed4b039a94cefc9dfa4498" class="PageRoot"><ul id="https://www.notion.so/58bb3e5f20484a6c8b3417fb76d420b0" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/1d4b5737fdbd49bf8d9950733f52ec78"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">1 引言</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/b78cdf42f8514263a954bdf51683681b"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">2 背景</span></span></div></a></li></ul><h2 id="https://www.notion.so/1d4b5737fdbd49bf8d9950733f52ec78" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/1d4b5737fdbd49bf8d9950733f52ec78"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">1 引言</span></span></h2><div id="https://www.notion.so/0977cd84b58f46e9bb69972f2a9782eb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">来自单个细胞的蛋白质信号网络的结构是什么？不同的习惯如何影响疾病的出现？这样的问题涉及由非线性的有噪声的过程控制的复杂系统中的因果效应。在大多数场合下，这样的系统的被动观测是不足以发现真实的因果效应关系的，需要开销大的实验来消除相互竞争的假设间的不明确性。因此，实验的设计是很令人感兴趣的，有效的实验方案有助于降低实验的成本，同时通过（闭环的 / 策略驱动的）科学方法帮助产出知识的过程（图 1）。</span></span></p></div><div id="https://www.notion.so/811f8c85b68c408780aeed554b958e27" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F6009403b-a552-4c16-9893-ca7bd2f47ef1%2FUntitled.png?width=384&amp;table=block&amp;id=811f8c85-b68c-4087-80ae-ed554b958e27"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F6009403b-a552-4c16-9893-ca7bd2f47ef1%2FUntitled.png?width=384&amp;table=block&amp;id=811f8c85-b68c-4087-80ae-ed554b958e27" style="width:384px"/></a><figcaption><span class="SemanticStringArray"><span class="SemanticString">图 1 用于因果推断框架的贝叶斯最优实验设计的干预-推断-设计循环。</span></span></figcaption></figure></div><div id="https://www.notion.so/19042413fdb94205aeb7326a50821638" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在因果的语言中，因果关系被一个有向无环图（DAG）定性地表示，图中节点对应于研究的系统中不同的变量，边表示变量间的信息流。DAG 的抽象使得我们可以表示眼前的观测的可能解释（假设）空间。以贝叶斯概率（信念）表示这样的假设允许我们将科学方法的问题形式化为一个贝叶斯推断，其中目标是要估计后验分布 </span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Math" data-latex="p(\text{DAGs}\,|\,\text{Observations})"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mtext>DAGs</mtext><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mtext>Observations</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\text{DAGs}\,|\,\text{Observations})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord text"><span class="mord">DAGs</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">Observations</span></span><span class="mclose">)</span></span></span></span></span></span><span class="SemanticString">。DAG 上的后验概率可以允许我们使用信息论的获得函数，该函数指导实验朝着最具信息量的变量进行，以消除互相竞争的假设间的不明确性。这样的设计过程属于用于</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">因果发现</em></span><span class="SemanticString">的</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">贝叶斯最优实验设计</em></span><span class="SemanticString">（BOECD）的领域。</span></span></p></div><div id="https://www.notion.so/1bc968187d874558ab5bd29cd0eb076b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">贝叶斯最优实验设计</em></span><span class="SemanticString">（BOED）的框架中，要寻找能够最大化关于某些感兴趣参数的</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">期望信息增益</em></span><span class="SemanticString">的实验。在</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">因果发现</em></span><span class="SemanticString">中，实验是因果干预的形式，感兴趣的参数是结构因果模型（SCM）及其相关联的 DAG。</span></span></p></div><div id="https://www.notion.so/ee5a1ad7182c448895b15e7059b36491" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">因果模型中的干预指的是我们操作的变量（或目标）和我们要将该变量设定为的值（或强度）。因此，对于学习因果模型的设计空间就是干预目标的所有子集和所选目标的干预值的可能可数无穷集合的集合。干预值封装了在许多因果推断应用中重要的语义。例如，在药物应用中，干预可以对应于不同药物的给药，干预值以每种药物的剂量水平的形式存在。尽管该值的适当选择对于确定底层的因果模型至关重要，但现有的主动因果发现的工作只关注于选择干预目标。这样的工作中，干预值通常都是某个任意的固定值（比如 0），这是次优的（见图 2a）。因此，</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue">在非线性因果模型的一般情况下，缺乏对干预值和干预目标选择的整体处理</mark></span><span class="SemanticString">。本文提出了一个贝叶斯实验设计方法（CBED，读音为“seabed”），通过贝叶斯优化来获得最优的干预目标和干预值。</span></span></p></div><div id="https://www.notion.so/7b90031deeef413ba2c385654ba811dc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">此外，一些情境要求选择一批干预。批量干预的问题计算很昂贵，因为它需要评估所有可能的干预组合。我们将 CBED 扩展到批设定下，并提出了两种不同的批策略，用于获取可解的贝叶斯最优干预目标和值。第一个策略 Greedy-CBED 贪心地构建干预集。由于互信息的子模块性，贪心启发式算法仍然是接近最优的。第二种策略 Soft-CBED 通过从有限的候选集合中随机抽样构建一组干预，从而显著提高了计算效率，恢复 DAG 结构和 SCM 的参数，速度与贪心策略一样快。这种策略非常适合资源受限的情境。</span></span></p></div><div id="https://www.notion.so/7c263cae152144b5a7adf00b26367b40" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在整个工作中，我们做了如下的因果发现的标准假设：</span></span></p></div><div id="https://www.notion.so/7e3ac67d7fc943a499e138c66122bc9a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">假设 1</strong></span><span class="SemanticString">（因果充分性）没有隐藏的混淆因子，所有感兴趣的随机变量都是可观测的。</span></span></p></div><div id="https://www.notion.so/d506ef086ec6476fbbd34f5679fc9932" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">假设 2</strong></span><span class="SemanticString">（有限样本）可用的观测 / 干预样本数量有限。</span></span></p></div><div id="https://www.notion.so/8f93331d95054e5bb88ecd2f90d46d37" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">假设 3</strong></span><span class="SemanticString">（有加性噪声的非线性 SCM）结构因果模型具有附加高斯噪声的非线性条件期望。</span></span></p></div><div id="https://www.notion.so/178644cc477742ed8b2369ddadf9b160" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">假设 4</strong></span><span class="SemanticString">（单目标）每个干预都是原子的，并应用于 SCM 的单个目标。</span></span></p></div><div id="https://www.notion.so/e9761230f3a74442b8149b1e5329eb73" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">此外，我们假设干预以大小为 </span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Math" data-latex="\mathcal{B}"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">B</mi></mrow><annotation encoding="application/x-tex">\mathcal{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.03041em;">B</span></span></span></span></span></span></span><span class="SemanticString"> 的批来设计并执行的，全部干预的固定预算由 </span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Math" data-latex="\text{Number of Batches}\times\mathcal{B}"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Number of Batches</mtext><mo>×</mo><mi mathvariant="script">B</mi></mrow><annotation encoding="application/x-tex">\text{Number of Batches}\times\mathcal{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord text"><span class="mord">Number of Batches</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.03041em;">B</span></span></span></span></span></span></span><span class="SemanticString"> 给出。我们也假设底层的图是稀疏的，因为所有现实世界设定中也是这样。实验设计在稀疏图设定中更合适，因为信息量大的干预目标和值的数量会比稠密图的少得多。对应于稀疏图的许多节点具有父集的概率非常小，因此使用随机策略进行实验不能最大程度地提供信息。最后，我们对于用少数量的批来恢复全图 </span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Math" data-latex="\mathbf{G}"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">G</mi></mrow><annotation encoding="application/x-tex">\mathbf{G}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">G</span></span></span></span></span></span></span><span class="SemanticString"> 很有兴趣。和所有的因果推断任务一样，我们上面做出的假设要被小心地对感兴趣的应用验证。</span></span></p></div><div id="https://www.notion.so/0aa11debbcd44753b12bdcf7aa4cf768" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">我们证明了我们的方法 Greedy-CBED 和 Soft-CBED 在线性和非线性 SCM 设定中表现得比最先进的主动因果发现基线更好。此外，我们的方法在受现实世界启发的非线性数据集 DREAM 中取得了优异的结果。</span></span></p></div><h2 id="https://www.notion.so/b78cdf42f8514263a954bdf51683681b" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/b78cdf42f8514263a954bdf51683681b"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">2 背景</span></span></h2><div id="https://www.notion.so/e6a5d874e3b34998afaf961099af0505" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div></article>
  <footer class="Footer">
  <div>&copy; Patrick’s Blog 2023</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>

</body>

</html>